<!DOCTYPE html>
<html>

<link rel="import" href="tangojs-label.html">

<script type="text/javascript">
(function (window) {
  'use strict'

  const tangojs = window.tangojs

  const TangoJsLabelElement = window.tangojs.web.components.TangoJsLabelElement

  class TangoJsLineEditElement extends TangoJsLabelElement {

    createLocalDom () {
      const dom = super.createLocalDom()
      const input = this.createFlexFormField('input', 3, 1)
      input.element.oninput = (event) => this.onInput(event)
      dom.grid.appendChild(input.flex)
      dom.input = input.element
      return dom
    }

    onInput (event) {
      const deviceAttribute = new tangojs.struct.DeviceAttribute({
        value: event.target.value
      })
      this.proxy[0]
        .write(deviceAttribute)
        .catch(e => console.error(e))
    }
  }

  window.tangojs.web.util.registerComponent('tangojs-line-edit',
                                            TangoJsLineEditElement,
                                            {
                                              multipleModels: false,
                                              attributes: true,
                                              commands: false,
                                              status: false,
                                              readOnly: false
                                            },
                                            {
                                              model: {
                                                type: String,
                                                defaultValue: ''
                                              },
                                              poolPeriod: {
                                                type: Number,
                                                defaultValue: 1000
                                              },
                                              showQuality: {
                                                type: Boolean,
                                                defaultValue: true
                                              },
                                              showName: {
                                                type: Boolean,
                                                defaultValue: true
                                              },
                                              showUnit: {
                                                type: Boolean,
                                                defaultValue: true
                                              }
                                            })

})(window)

</script>

</html>
